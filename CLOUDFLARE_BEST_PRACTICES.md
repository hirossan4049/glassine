# Cloudflare Pages & Workers ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹

ã“ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã§ã¯ã€Glassine ã®ã‚ˆã†ãª Vite + React ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ã‚’ Cloudflare ã§åŠ¹ç‡çš„ã«é‹ç”¨ã™ã‚‹ãŸã‚ã®æ¨å¥¨æ§‹æˆã‚’è§£èª¬ã—ã¾ã™ã€‚

## ç›®æ¬¡

1. [Pages ã¨ Workers ã®å½¹å‰²åˆ†æ‹…](#1-pages-ã¨-workers-ã®å½¹å‰²åˆ†æ‹…)
2. [æ¨å¥¨æ§‹æˆ](#2-æ¨å¥¨æ§‹æˆ)
3. [ãªãœ Workers å˜ä½“ã§ã¯ãªã Pagesï¼ˆï¼‹Functionsï¼‰ãŒé©åˆ‡ã‹](#3-ãªãœ-workers-å˜ä½“ã§ã¯ãªã-pagesfunctions-ãŒé©åˆ‡ã‹)
4. [å°†æ¥ API ã‚’æ‹¡å¼µã™ã‚‹éš›ã®ã‚¹ã‚±ãƒ¼ãƒ«ã—ã‚„ã™ã„è¨­è¨ˆæ–¹é‡](#4-å°†æ¥-api-ã‚’æ‹¡å¼µã™ã‚‹éš›ã®ã‚¹ã‚±ãƒ¼ãƒ«ã—ã‚„ã™ã„è¨­è¨ˆæ–¹é‡)
5. [ã‚ˆãã‚ã‚‹ãƒˆãƒ©ãƒ–ãƒ«ã¨è§£æ±ºæ–¹æ³•](#5-ã‚ˆãã‚ã‚‹ãƒˆãƒ©ãƒ–ãƒ«ã¨è§£æ±ºæ–¹æ³•)

---

## 1. Pages ã¨ Workers ã®å½¹å‰²åˆ†æ‹…

### Cloudflare Pages

**ç”¨é€”**: é™çš„ã‚µã‚¤ãƒˆãƒ»SPA ã®ãƒ›ã‚¹ãƒ†ã‚£ãƒ³ã‚° + è»½é‡ãªã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰å‡¦ç†

| æ©Ÿèƒ½ | èª¬æ˜ |
|------|------|
| é™çš„ãƒ•ã‚¡ã‚¤ãƒ«é…ä¿¡ | HTML, CSS, JS, ç”»åƒãªã©ã‚’ CDN ã‹ã‚‰é«˜é€Ÿé…ä¿¡ |
| SPA ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚° | React/Vue/Angular ãªã©ã® SPA ã‚’è‡ªå‹•å¯¾å¿œ |
| Pages Functions | `/functions` ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã§ã‚µãƒ¼ãƒãƒ¼ãƒ¬ã‚¹ API ã‚’å®šç¾© |
| Preview ãƒ‡ãƒ—ãƒ­ã‚¤ | PR ã”ã¨ã«è‡ªå‹•ã§ãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ç’°å¢ƒã‚’ä½œæˆ |
| Git é€£æº | GitHub/GitLab ã¨é€£æºã—ãŸè‡ªå‹•ãƒ‡ãƒ—ãƒ­ã‚¤ |

### Cloudflare Workers

**ç”¨é€”**: é«˜åº¦ãªã‚¨ãƒƒã‚¸ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°ãƒ»ãƒ•ãƒ«ã‚¹ã‚¿ãƒƒã‚¯ API

| æ©Ÿèƒ½ | èª¬æ˜ |
|------|------|
| ã‚«ã‚¹ã‚¿ãƒ ãƒ­ã‚¸ãƒƒã‚¯ | è¤‡é›‘ãªãƒªã‚¯ã‚¨ã‚¹ãƒˆå‡¦ç†ã€ãƒ—ãƒ­ã‚­ã‚·ã€å¤‰æ› |
| ã‚¹ã‚¿ãƒ³ãƒ‰ã‚¢ãƒ­ãƒ³ API | ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ãªã—ã®ç´”ç²‹ãª API ã‚µãƒ¼ãƒãƒ¼ |
| é«˜åº¦ãªãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚° | è¤‡é›‘ãªãƒ‘ã‚¹åˆ¶å¾¡ã‚„ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆ |

### å½¹å‰²åˆ†æ‹…ã®æ¨å¥¨

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Cloudflare Pages                      â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚  é™çš„ã‚¢ã‚»ãƒƒãƒˆ (React SPA)                           â”‚â”‚
â”‚  â”‚  - dist/index.html                                  â”‚â”‚
â”‚  â”‚  - dist/assets/*.js, *.css                          â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚  Pages Functions (ã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰å‡¦ç†)               â”‚â”‚
â”‚  â”‚  - functions/api/[[path]].ts  â†’ API ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ â”‚â”‚
â”‚  â”‚  - functions/_middleware.ts    â†’ OGP æ³¨å…¥ãªã©       â”‚â”‚
â”‚  â”‚  - functions/og/[[path]].ts    â†’ å‹•çš„ OG ç”»åƒç”Ÿæˆ   â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚  ãƒã‚¤ãƒ³ãƒ‡ã‚£ãƒ³ã‚°                                      â”‚â”‚
â”‚  â”‚  - D1 ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹                                  â”‚â”‚
â”‚  â”‚  - KV ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸                                    â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**çµè«–**: Glassine ã®ã‚ˆã†ãªãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ + API ã®æ§‹æˆã§ã¯ã€**Cloudflare Pages + Pages Functions** ãŒæœ€é©ã§ã™ã€‚

---

## 2. æ¨å¥¨æ§‹æˆ

### ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªæ§‹é€ 

```
glassine/
â”œâ”€â”€ src/                          # React ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰
â”‚   â”œâ”€â”€ App.tsx
â”‚   â”œâ”€â”€ main.tsx
â”‚   â”œâ”€â”€ components/
â”‚   â””â”€â”€ types/
â”œâ”€â”€ functions/                    # Pages Functionsï¼ˆã‚µãƒ¼ãƒãƒ¼ã‚µã‚¤ãƒ‰ï¼‰
â”‚   â”œâ”€â”€ _middleware.ts           # å…¨ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’å‡¦ç†ã™ã‚‹ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢
â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â””â”€â”€ [[path]].ts          # API ãƒ«ãƒ¼ãƒˆï¼ˆHono ä½¿ç”¨ï¼‰
â”‚   â””â”€â”€ og/
â”‚       â””â”€â”€ [[path]].ts          # å‹•çš„ OG ç”»åƒç”Ÿæˆ
â”œâ”€â”€ public/                       # é™çš„ãƒ•ã‚¡ã‚¤ãƒ«
â”œâ”€â”€ dist/                         # ãƒ“ãƒ«ãƒ‰å‡ºåŠ›ï¼ˆ.gitignore æ¨å¥¨ï¼‰
â”œâ”€â”€ schema/                       # D1 ã‚¹ã‚­ãƒ¼ãƒ
â”œâ”€â”€ wrangler.toml                 # Cloudflare è¨­å®š
â”œâ”€â”€ package.json
â”œâ”€â”€ vite.config.ts
â””â”€â”€ tsconfig.json
```

### wrangler.tomlï¼ˆç¾åœ¨ã®æ­£ã—ã„è¨­å®šï¼‰

```toml
name = "glassine"
compatibility_date = "2024-01-01"
pages_build_output_dir = "dist"

[env.production]
vars = { ENVIRONMENT = "production" }

[[d1_databases]]
binding = "DB"
database_name = "glassine-db"
database_id = "your-actual-database-id"  # wrangler d1 create ã§å–å¾—ã—ãŸ ID

[[kv_namespaces]]
binding = "KV"
id = "your-actual-kv-id"  # wrangler kv:namespace create ã§å–å¾—ã—ãŸ ID
```

> **ID ã®å–å¾—æ–¹æ³•**:
> - D1: `wrangler d1 create glassine-db` å®Ÿè¡Œæ™‚ã«å‡ºåŠ›ã•ã‚Œã‚‹ `database_id`
> - KV: `wrangler kv:namespace create "KV"` å®Ÿè¡Œæ™‚ã«å‡ºåŠ›ã•ã‚Œã‚‹ `id`
> - ã¾ãŸã¯ Cloudflare Dashboard â†’ Workers & Pages â†’ D1/KV ã§ç¢ºèªå¯èƒ½

### Cloudflare Dashboard è¨­å®š

**é‡è¦**: GitHub é€£æºã§ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹éš›ã€ä»¥ä¸‹ã‚’ç¢ºèªã—ã¦ãã ã•ã„ï¼š

1. **Workers & Pages** â†’ **Create application** â†’ **Pages** ã‚’é¸æŠ
   - âŒ ã€ŒWorkersã€ã‚’é¸æŠã—ãªã„ã§ãã ã•ã„
   
2. **Connect to Git** ã§ãƒªãƒã‚¸ãƒˆãƒªã‚’æ¥ç¶š

3. ãƒ“ãƒ«ãƒ‰è¨­å®š:
   | é …ç›® | å€¤ |
   |------|-----|
   | Framework preset | Noneï¼ˆã¾ãŸã¯ Vite ã‚’é¸æŠï¼‰ |
   | Build command | `npm run build` |
   | Build output directory | `dist` |
   | Root directory | `/`ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆï¼‰ |

4. **Environment variables**ï¼ˆå¿…è¦ã«å¿œã˜ã¦ï¼‰

5. **Functions** ã‚¿ãƒ–ã§ D1 ã¨ KV ã®ãƒã‚¤ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ã‚’è¨­å®š:
   - D1: `DB` â†’ `glassine-db` ã‚’é¸æŠ
   - KV: `KV` â†’ ä½œæˆã—ãŸ KV namespace ã‚’é¸æŠ

---

## 3. ãªãœ Workers å˜ä½“ã§ã¯ãªã Pagesï¼ˆï¼‹Functionsï¼‰ãŒé©åˆ‡ã‹

### æ¯”è¼ƒè¡¨

| æ©Ÿèƒ½ | Workers å˜ä½“ | Pages + Functions |
|------|-------------|-------------------|
| é™çš„ãƒ•ã‚¡ã‚¤ãƒ«é…ä¿¡ | æ‰‹å‹•ã§å®Ÿè£…ãŒå¿…è¦ | âœ… è‡ªå‹•ãƒ»æœ€é©åŒ–æ¸ˆã¿ |
| SPA ãƒ«ãƒ¼ãƒ†ã‚£ãƒ³ã‚° | æ‰‹å‹•ã§å®Ÿè£…ãŒå¿…è¦ | âœ… è‡ªå‹•å¯¾å¿œ |
| Preview ãƒ‡ãƒ—ãƒ­ã‚¤ | ãªã— | âœ… PR ã”ã¨ã«è‡ªå‹•ç”Ÿæˆ |
| Git é€£æº | è¨­å®šãŒè¤‡é›‘ | âœ… ãƒ¯ãƒ³ã‚¯ãƒªãƒƒã‚¯é€£æº |
| D1/KV ãƒã‚¤ãƒ³ãƒ‡ã‚£ãƒ³ã‚° | âœ… å¯¾å¿œ | âœ… å¯¾å¿œ |
| ãƒ“ãƒ«ãƒ‰ã‚­ãƒ£ãƒƒã‚·ãƒ¥ | ãªã— | âœ… é«˜é€Ÿãƒ“ãƒ«ãƒ‰ |
| ãƒ­ãƒ¼ãƒ«ãƒãƒƒã‚¯ | æ‰‹å‹• | âœ… ãƒ¯ãƒ³ã‚¯ãƒªãƒƒã‚¯ |

### Workers å˜ä½“ã‚’é¸ã¶ã¹ãã‚±ãƒ¼ã‚¹

1. ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ãŒãªã„ç´”ç²‹ãª API ã‚µãƒ¼ãƒãƒ¼
2. è¤‡é›‘ãªãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒ—ãƒ­ã‚­ã‚·ã‚„ã‚¨ãƒƒã‚¸å‡¦ç†
3. WebSocket ã‚µãƒ¼ãƒãƒ¼ï¼ˆDurable Objects ä½¿ç”¨ï¼‰
4. ä»–ã‚µãƒ¼ãƒ“ã‚¹ã¸ã®ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ä¸è¦ãªé€£æº

### Pages + Functions ã‚’é¸ã¶ã¹ãã‚±ãƒ¼ã‚¹ï¼ˆGlassine ã«è©²å½“ï¼‰

1. âœ… React/Vue/Next.js ãªã©ã® SPAãƒ»SSR ã‚¢ãƒ—ãƒª
2. âœ… ãƒ•ãƒ­ãƒ³ãƒˆã‚¨ãƒ³ãƒ‰ + API ã®çµ±åˆã‚¢ãƒ—ãƒª
3. âœ… OGP å‹•çš„ç”ŸæˆãŒå¿…è¦
4. âœ… D1/KV ã‚’ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã¨ã—ã¦ä½¿ç”¨
5. âœ… GitHub é€£æºã§ã® CI/CD

### ã€ŒHello Worldã€ãŒè¡¨ç¤ºã•ã‚Œã‚‹åŸå› 

Workers ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¨ã—ã¦ä½œæˆã™ã‚‹ã¨ã€ä»¥ä¸‹ã®ã‚ˆã†ãªãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã‚³ãƒ¼ãƒ‰ãŒãƒ‡ãƒ—ãƒ­ã‚¤ã•ã‚Œã¾ã™ï¼š

```javascript
export default {
  async fetch(request) {
    return new Response("Hello World!");
  }
};
```

**è§£æ±ºç­–**: Cloudflare Dashboard ã§ï¼š
1. æ—¢å­˜ã® Workers ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’å‰Šé™¤
2. **Pages** ã¨ã—ã¦æ–°ã—ããƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’ä½œæˆ
3. GitHub ãƒªãƒã‚¸ãƒˆãƒªã‚’å†æ¥ç¶š

---

## 4. å°†æ¥ API ã‚’æ‹¡å¼µã™ã‚‹éš›ã®ã‚¹ã‚±ãƒ¼ãƒ«ã—ã‚„ã™ã„è¨­è¨ˆæ–¹é‡

### ç¾åœ¨ã® API æ§‹é€ ï¼ˆHono ãƒ™ãƒ¼ã‚¹ï¼‰

```typescript
// functions/api/[[path]].ts
import { Hono } from 'hono';

const app = new Hono<{ Bindings: Env }>();

app.post('/events', async (c) => { ... });
app.get('/events/:id', async (c) => { ... });
app.post('/events/:id/responses', async (c) => { ... });

export const onRequest = app.fetch;
```

### æ‹¡å¼µã®ãƒ™ã‚¹ãƒˆãƒ—ãƒ©ã‚¯ãƒ†ã‚£ã‚¹

#### 1. ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«åˆ†å‰²

```
functions/
â”œâ”€â”€ api/
â”‚   â”œâ”€â”€ [[path]].ts           # ã‚¨ãƒ³ãƒˆãƒªãƒ¼ãƒã‚¤ãƒ³ãƒˆ
â”‚   â”œâ”€â”€ routes/
â”‚   â”‚   â”œâ”€â”€ events.ts         # ã‚¤ãƒ™ãƒ³ãƒˆé–¢é€£ API
â”‚   â”‚   â”œâ”€â”€ responses.ts      # å›ç­”é–¢é€£ API
â”‚   â”‚   â”œâ”€â”€ users.ts          # å°†æ¥ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ API
â”‚   â”‚   â””â”€â”€ notifications.ts  # å°†æ¥ã®é€šçŸ¥ API
â”‚   â””â”€â”€ middleware/
â”‚       â”œâ”€â”€ auth.ts           # èªè¨¼ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢
â”‚       â””â”€â”€ rateLimit.ts      # ãƒ¬ãƒ¼ãƒˆåˆ¶é™
```

#### 2. å…±é€šå‡¦ç†ã®æŠ½å‡º

```typescript
// functions/api/middleware/auth.ts
import type { Context, Next } from 'hono';

export async function authMiddleware(c: Context, next: Next) {
  const token = c.req.query('token');
  if (!token) {
    return c.json({ error: 'Token required' }, 401);
  }
  await next();
}
```

#### 3. ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³å±¤ã®è¿½åŠ 

```typescript
// zod ã‚„ valibot ã§ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
import { z } from 'zod';

const CreateEventSchema = z.object({
  title: z.string().min(1).max(100),
  description: z.string().max(500).optional(),
  slots: z.array(z.object({
    start: z.number(),
    end: z.number(),
  })).min(1),
});
```

#### 4. ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°çµ±ä¸€

```typescript
// functions/api/utils/errors.ts
export class ApiError extends Error {
  constructor(
    public statusCode: number,
    message: string
  ) {
    super(message);
  }
}

// ã‚°ãƒ­ãƒ¼ãƒãƒ«ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒ©
app.onError((err, c) => {
  if (err instanceof ApiError) {
    return c.json({ error: err.message }, err.statusCode);
  }
  console.error(err);
  return c.json({ error: 'Internal Server Error' }, 500);
});
```

#### 5. ã‚­ãƒ£ãƒƒã‚·ãƒ¥æˆ¦ç•¥ï¼ˆKV æ´»ç”¨ï¼‰

```typescript
// èª­ã¿å–ã‚ŠãŒå¤šã„ãƒ‡ãƒ¼ã‚¿ã¯KVã«ã‚­ãƒ£ãƒƒã‚·ãƒ¥
async function getEventWithCache(c: Context, eventId: string) {
  const cacheKey = `event:${eventId}`;
  
  // ã‚­ãƒ£ãƒƒã‚·ãƒ¥ãƒã‚§ãƒƒã‚¯
  const cached = await c.env.KV.get(cacheKey, 'json');
  if (cached) return cached;
  
  // DB ã‹ã‚‰å–å¾—
  const event = await fetchEventFromDB(c.env.DB, eventId);
  
  // ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã«ä¿å­˜ï¼ˆ1æ™‚é–“ï¼‰
  await c.env.KV.put(cacheKey, JSON.stringify(event), {
    expirationTtl: 3600,
  });
  
  return event;
}
```

#### 6. å°†æ¥ã®æ©Ÿèƒ½è¿½åŠ ãƒ‘ã‚¿ãƒ¼ãƒ³

```
ğŸ“‚ è¿½åŠ å¯èƒ½ãªæ©Ÿèƒ½
â”œâ”€â”€ ğŸ“§ é€šçŸ¥æ©Ÿèƒ½
â”‚   â””â”€â”€ Cloudflare Queues + Email Workers
â”œâ”€â”€ ğŸ“Š åˆ†ææ©Ÿèƒ½
â”‚   â””â”€â”€ Analytics Engine + D1
â”œâ”€â”€ ğŸ” èªè¨¼æ©Ÿèƒ½
â”‚   â””â”€â”€ Cloudflare Access ã¾ãŸã¯ JWT
â”œâ”€â”€ ğŸ“ ãƒ•ã‚¡ã‚¤ãƒ«ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰
â”‚   â””â”€â”€ R2 ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸
â””â”€â”€ ğŸ”„ ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ›´æ–°
    â””â”€â”€ Durable Objects + WebSocket
```

---

## 5. ã‚ˆãã‚ã‚‹ãƒˆãƒ©ãƒ–ãƒ«ã¨è§£æ±ºæ–¹æ³•

### å•é¡Œ: Workers ã§ã€ŒHello Worldã€ãŒè¿”ã‚‹

**åŸå› **: Workers ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¨ã—ã¦ä½œæˆã•ã‚ŒãŸ

**è§£æ±ºç­–**:
1. Cloudflare Dashboard â†’ Workers & Pages
2. è©²å½“ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’å‰Šé™¤
3. **Create application** â†’ **Pages** ã‚’é¸æŠ
4. **Connect to Git** ã§ãƒªãƒã‚¸ãƒˆãƒªã‚’æ¥ç¶š
5. ãƒ“ãƒ«ãƒ‰è¨­å®šã‚’å…¥åŠ›ã—ã¦ãƒ‡ãƒ—ãƒ­ã‚¤

### å•é¡Œ: Pages Functions ãŒå‹•ä½œã—ãªã„

**ç¢ºèªé …ç›®**:
1. `functions/` ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãŒãƒªãƒã‚¸ãƒˆãƒªã«å­˜åœ¨ã™ã‚‹ã‹
2. TypeScript ãŒæ­£ã—ãã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã•ã‚Œã¦ã„ã‚‹ã‹
3. D1/KV ã®ãƒã‚¤ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ãŒ Dashboard ã§è¨­å®šã•ã‚Œã¦ã„ã‚‹ã‹

**ãƒ‡ãƒãƒƒã‚°æ–¹æ³•**:
```bash
# ãƒ­ãƒ¼ã‚«ãƒ«ã§ãƒ†ã‚¹ãƒˆ
npm run build
npx wrangler pages dev dist
```

### å•é¡Œ: D1 ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ããªã„

**è§£æ±ºç­–**:
1. Dashboard â†’ Pages â†’ ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ â†’ Settings â†’ Functions
2. D1 database bindings ã§ `DB` â†’ `glassine-db` ã‚’è¨­å®š
3. å†ãƒ‡ãƒ—ãƒ­ã‚¤

### å•é¡Œ: ãƒ­ãƒ¼ã‚«ãƒ«é–‹ç™ºã§ API ãŒå‹•ã‹ãªã„

```bash
# æ­£ã—ã„ã‚³ãƒãƒ³ãƒ‰ï¼ˆPages ç”¨ï¼‰
npx wrangler pages dev dist --d1=DB=glassine-db --kv=KV

# âŒ é–“é•ã„ï¼ˆWorkers ç”¨ï¼‰
npx wrangler dev
```

---

## ã¾ã¨ã‚

| é …ç›® | æ¨å¥¨ |
|------|------|
| ãƒ›ã‚¹ãƒ†ã‚£ãƒ³ã‚° | Cloudflare Pages |
| API | Pages Functionsï¼ˆ`/functions` ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªï¼‰ |
| ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ | Honoï¼ˆè»½é‡ãƒ»é«˜é€Ÿï¼‰ |
| ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ | D1ï¼ˆSQLite ãƒ™ãƒ¼ã‚¹ï¼‰ |
| ã‚­ãƒ£ãƒƒã‚·ãƒ¥ | KVï¼ˆå°†æ¥çš„ã«æ´»ç”¨ï¼‰ |
| ãƒ‡ãƒ—ãƒ­ã‚¤ | GitHub é€£æºï¼ˆè‡ªå‹•ï¼‰ |

**Glassine ã®ç¾åœ¨ã®æ§‹æˆã¯æ­£ã—ãè¨­è¨ˆã•ã‚Œã¦ã„ã¾ã™ã€‚**  
Dashboard è¨­å®šãŒã€ŒWorkersã€ã«ãªã£ã¦ã„ã‚‹å ´åˆã¯ã€ã€ŒPagesã€ã¨ã—ã¦å†ä½œæˆã—ã¦ãã ã•ã„ã€‚
